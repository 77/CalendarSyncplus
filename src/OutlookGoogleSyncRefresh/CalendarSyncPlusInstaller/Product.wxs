<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="Calendar Sync +" Language="1033" Version="1.3.2.0" Manufacturer="Ankesh Dave and Akanksha Gaur" UpgradeCode="6A7B72FC-ED9B-4951-B733-AB54B8D4AE94">
    <!--UpgradeCode="baa289c2-bd23-4f36-969a-506ee9dc0e5d">-->
    <Package InstallerVersion="200" Manufacturer="Ankesh Dave and Akanksha Gaur"
             Compressed="yes" InstallScope="perMachine" Description="A utility to synchronize Outlook to Google calendars and vice versa."/>
    
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." AllowDowngrades="no" AllowSameVersionUpgrades="yes"
                  Schedule="afterInstallInitialize"/>
    <MediaTemplate />

    <Feature Id="ProductFeature" Title="Calendar Sync +" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>
  </Product>
  <?define ProjectDirectory = "..\OutlookGoogleSyncRefresh.Presentation\bin\Release"?>
  <?define BclAsyncDirectory = "..\packages\Microsoft.Bcl.Async.1.0.168\lib\net40"?>
  <?define GACDirectory = "C:\Windows\assembly\GAC_MSIL\office\14.0.0.0__71e9bce111e9429c"?>
  <?define Net45Directory = "C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5"?>
  <?define Net45FacadeDirectory = "$(var.Net45Directory)\Facades"?>
  <?define Office14Directory ="C:\Program Files (x86)\Microsoft Visual Studio 12.0\Visual Studio Tools for Office\PIA\Office14"?>
  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="Calendar Sync +" />
        <!--<Directory Id="ProgramMenuFolder">
          <Directory Id="CalendarSyncPlusShortcut"
                     Name="Calendar Sync +" />
        </Directory>-->
      </Directory>
    </Directory>
  </Fragment>
  <!--<Fragment>
    <Icon Id="ShortcutIcon" SourceFile="icon.ico"/>
    <ComponentGroup Id="ShortcutComponents" Directory="CalendarSyncPlusShortcut">
      <Component Id="CMP_DocumentationShortcut"
             Guid="33741C82-30BF-41AF-8246-44A5DCFCF953">

        <Shortcut Id="UninstallShortcut"
            Name="Uninstall Calendar Sync +"
            Description= "Uninstalls Calendar Sync + and all of its components"
            Target="[System64Folder]CalendarSyncPlus.exe"
            Arguments="/x [ProductCode]" Icon="ShortcutIcon"/>
        --><!--<Shortcut Id="DocumentationStartMenuShortcut"
                Name="Awesome Software Documentation"
                Description="Read Awesome Software Documentation"
                Target="[MyProgramDir]InstallMe.txt" />--><!--
        <RemoveFolder Id="RemoveMyShortcutsDir"
                      On="uninstall" Directory="CalendarSyncPlusShortcut"/>
        <RegistryValue Root="HKCU"
                       Key="Software\Microsoft\CalendarSyncPlus"
                       Name="installed"
                       Type="integer"
                       Value="1"
                       KeyPath="yes" />
      </Component>
    </ComponentGroup>
  </Fragment>-->
  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <!-- TODO: Remove the comments around this Component element and the ComponentRef below in order to add resources to this installer. -->
      <!-- <Component Id="ProductComponent"> -->
      <!-- TODO: Insert files, registry keys, and other resources here. -->
      <!-- </Component> -->

      <!--Project Outputs-->
      <Component>
        <File Id="CalendarSyncPlus.Common.Output"
            Name="CalendarSyncPlus.Common.dll"
            Source="$(var.ProjectDirectory)\CalendarSyncPlus.Common.dll"
            KeyPath="yes" />
      </Component>

      <Component>
        <File Id="CalendarSyncPlus.Domain.Output"
            Name="CalendarSyncPlus.Domain.dll"
            Source="$(var.ProjectDirectory)\CalendarSyncPlus.Domain.dll"
            KeyPath="yes" />
      </Component>

      <Component>
        <File Id="CalendarSyncPlus.Services.Output"
            Name="CalendarSyncPlus.Services.dll"
            Source="$(var.ProjectDirectory)\CalendarSyncPlus.Services.dll"
            KeyPath="yes" />
      </Component>
      <Component>
        <File Id="CalendarSyncPlus.OutlookServices.Output"
            Name="CalendarSyncPlus.OutlookServices.dll"
            Source="$(var.ProjectDirectory)\CalendarSyncPlus.OutlookServices.dll"
            KeyPath="yes" />
      </Component>
      <Component>
        <File Id="CalendarSyncPlus.GoogleServices.Output"
            Name="CalendarSyncPlus.GoogleServices.dll"
            Source="$(var.ProjectDirectory)\CalendarSyncPlus.GoogleServices.dll"
            KeyPath="yes" />
      </Component>
      <Component>
        <File Id="CalendarSyncPlus.ExchangeWebServices.Output"
            Name="CalendarSyncPlus.ExchangeWebServices.dll"
            Source="$(var.ProjectDirectory)\CalendarSyncPlus.ExchangeWebServices.dll"
            KeyPath="yes" />
      </Component>

      <Component>
        <File Id="CalendarSyncPlus.Application.Output"
            Name="CalendarSyncPlus.Application.dll"
            Source="$(var.ProjectDirectory)\CalendarSyncPlus.Application.dll"
            KeyPath="yes" />
      </Component>

      <Component>
        <File Id="CalendarSyncPlus.Presentation.Output"
            Name="CalendarSyncPlus.exe"
            Source="$(var.ProjectDirectory)\CalendarSyncPlus.exe"
            KeyPath="yes" />
      </Component>
      <!--Project Dependencies-->
      <Component>
        <File Id="log4net"
          Name="log4net.dll"
          Source="$(var.ProjectDirectory)\log4net.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="WpfApplicationFramework"
          Name="WpfApplicationFramework.dll"
          Source="$(var.ProjectDirectory)\WpfApplicationFramework.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="MefContrib"
          Name="MefContrib.dll"
          Source="$(var.ProjectDirectory)\MefContrib.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="MahApps.Metro"
          Name="MahApps.Metro.dll"
          Source="$(var.ProjectDirectory)\MahApps.Metro.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="System.Windows.Interactivity"
          Name="System.Windows.Interactivity.dll"
          Source="$(var.ProjectDirectory)\System.Windows.Interactivity.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="Hardcodet.Wpf.TaskbarNotification"
          Name="Hardcodet.Wpf.TaskbarNotification.dll"
          Source="$(var.ProjectDirectory)\Hardcodet.Wpf.TaskbarNotification.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="Zlib.Portable"
          Name="Zlib.Portable.dll"
          Source="$(var.ProjectDirectory)\Zlib.Portable.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="Newtonsoft.Json"
          Name="Newtonsoft.Json.dll"
          Source="$(var.ProjectDirectory)\Newtonsoft.Json.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="System.Net.Http.Extensions"
          Name="System.Net.Http.Extensions.dll"
          Source="$(var.ProjectDirectory)\System.Net.Http.Extensions.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Net.Http.Primitives"
          Name="System.Net.Http.Primitives.dll"
          Source="$(var.ProjectDirectory)\System.Net.Http.Primitives.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="Microsoft.Threading.Tasks"
          Name="Microsoft.Threading.Tasks.dll"
          Source="$(var.BclAsyncDirectory)\Microsoft.Threading.Tasks.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="Microsoft.Threading.Tasks.Extensions"
          Name="Microsoft.Threading.Tasks.Extensions.dll"
          Source="$(var.BclAsyncDirectory)\Microsoft.Threading.Tasks.Extensions.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="Microsoft.Threading.Tasks.Extensions.Desktop"
          Name="Microsoft.Threading.Tasks.Extensions.Desktop.dll"
          Source="$(var.BclAsyncDirectory)\Microsoft.Threading.Tasks.Extensions.Desktop.dll"
          KeyPath="yes" />
      </Component>


      <Component>
        <File Id="Google.Apis.Core"
          Name="Google.Apis.Core.dll"
          Source="$(var.ProjectDirectory)\Google.Apis.Core.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="Google.Apis.Calendar.v3"
          Name="Google.Apis.Calendar.v3.dll"
          Source="$(var.ProjectDirectory)\Google.Apis.Calendar.v3.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="Google.Apis"
          Name="Google.Apis.dll"
          Source="$(var.ProjectDirectory)\Google.Apis.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="Google.Apis.Auth"
          Name="Google.Apis.Auth.dll"
          Source="$(var.ProjectDirectory)\Google.Apis.Auth.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="Google.Apis.Auth.PlatformServices"
          Name="Google.Apis.Auth.PlatformServices.dll"
          Source="$(var.ProjectDirectory)\Google.Apis.Auth.PlatformServices.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="Google.Apis.PlatformServices"
          Name="Google.Apis.PlatformServices.dll"
          Source="$(var.ProjectDirectory)\Google.Apis.PlatformServices.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="Microsoft.Office.Interop.Outlook"
          Name="Microsoft.Office.Interop.Outlook.dll"
          Source="$(var.Office14Directory)\Microsoft.Office.Interop.Outlook.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="office"
          Name="office.dll"
          Source="$(var.GACDirectory)\office.dll"
          KeyPath="yes" />
      </Component>
      <!--<Component>
        <File Id="stdole"
          Name="stdole.dll"
          Source="$(var.ProjectDirectory)\stdole.dll"
          KeyPath="yes" />
      </Component>-->
      <Component>
        <File Id="System.Collections.Concurrent"
          Name="System.Collections.Concurrent.dll"
          Source="$(var.Net45FacadeDirectory)\System.Collections.Concurrent.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Collections"
          Name="System.Collections.dll"
          Source="$(var.Net45FacadeDirectory)\System.Collections.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.ComponentModel"
          Name="System.ComponentModel.dll"
          Source="$(var.Net45FacadeDirectory)\System.ComponentModel.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.ComponentModel.Annotations"
          Name="System.ComponentModel.Annotations.dll"
          Source="$(var.Net45FacadeDirectory)\System.ComponentModel.Annotations.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.ComponentModel.EventBasedAsync"
          Name="System.ComponentModel.EventBasedAsync.dll"
          Source="$(var.Net45FacadeDirectory)\System.ComponentModel.EventBasedAsync.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="System.Diagnostics.Contracts"
          Name="System.Diagnostics.Contracts.dll"
          Source="$(var.Net45FacadeDirectory)\System.Diagnostics.Contracts.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Diagnostics.Debug"
          Name="System.Diagnostics.Debug.dll"
          Source="$(var.Net45FacadeDirectory)\System.Diagnostics.Debug.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Diagnostics.Tools"
          Name="System.Diagnostics.Tools.dll"
          Source="$(var.Net45FacadeDirectory)\System.Diagnostics.Tools.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Diagnostics.Tracing"
          Name="System.Diagnostics.Tracing.dll"
          Source="$(var.Net45FacadeDirectory)\System.Diagnostics.Tracing.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Dynamic.Runtime"
          Name="System.Dynamic.Runtime.dll"
          Source="$(var.Net45FacadeDirectory)\System.Dynamic.Runtime.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Globalization"
          Name="System.Globalization.dll"
          Source="$(var.Net45FacadeDirectory)\System.Globalization.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.IO"
          Name="System.IO.dll"
          Source="$(var.Net45FacadeDirectory)\System.IO.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Linq"
          Name="System.Linq.dll"
          Source="$(var.Net45FacadeDirectory)\System.Linq.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Linq.Expressions"
          Name="System.Linq.Expressions.dll"
          Source="$(var.Net45FacadeDirectory)\System.Linq.Expressions.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Linq.Parallel"
          Name="System.Linq.Parallel.dll"
          Source="$(var.Net45FacadeDirectory)\System.Linq.Parallel.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Linq.Queryable"
          Name="System.Linq.Queryable.dll"
          Source="$(var.Net45FacadeDirectory)\System.Linq.Queryable.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Net.Http"
          Name="System.Net.Http.dll"
          Source="$(var.Net45Directory)\System.Net.Http.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Net.Http.WebRequest"
          Name="System.Net.Http.WebRequest.dll"
          Source="$(var.Net45Directory)\System.Net.Http.WebRequest.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Net.NetworkInformation"
          Name="System.Net.NetworkInformation.dll"
          Source="$(var.Net45FacadeDirectory)\System.Net.NetworkInformation.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Net.Primitives"
          Name="System.Net.Primitives.dll"
          Source="$(var.Net45FacadeDirectory)\System.Net.Primitives.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Net.Requests"
          Name="System.Net.Requests.dll"
          Source="$(var.Net45FacadeDirectory)\System.Net.Requests.dll"
          KeyPath="yes" />
      </Component>

      <Component>
        <File Id="System.ObjectModel"
          Name="System.ObjectModel.dll"
          Source="$(var.Net45FacadeDirectory)\System.ObjectModel.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Reflection"
          Name="System.Reflection.dll"
          Source="$(var.Net45FacadeDirectory)\System.Reflection.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Reflection.Emit"
          Name="System.Reflection.Emit.dll"
          Source="$(var.Net45FacadeDirectory)\System.Reflection.Emit.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Reflection.Emit.ILGeneration"
          Name="System.Reflection.Emit.ILGeneration.dll"
          Source="$(var.Net45FacadeDirectory)\System.Reflection.Emit.ILGeneration.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Reflection.Emit.Lightweight"
          Name="System.Reflection.Emit.Lightweight.dll"
          Source="$(var.Net45FacadeDirectory)\System.Reflection.Emit.Lightweight.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Reflection.Extensions"
          Name="System.Reflection.Extensions.dll"
          Source="$(var.Net45FacadeDirectory)\System.Reflection.Extensions.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Reflection.Primitives"
          Name="System.Reflection.Primitives.dll"
          Source="$(var.Net45FacadeDirectory)\System.Reflection.Primitives.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Resources.ResourceManager"
          Name="System.Resources.ResourceManager.dll"
          Source="$(var.Net45FacadeDirectory)\System.Resources.ResourceManager.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Runtime"
          Name="System.Runtime.dll"
          Source="$(var.Net45FacadeDirectory)\System.Runtime.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Runtime.Extensions"
          Name="System.Runtime.Extensions.dll"
          Source="$(var.Net45FacadeDirectory)\System.Runtime.Extensions.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Runtime.InteropServices"
          Name="System.Runtime.InteropServices.dll"
          Source="$(var.Net45FacadeDirectory)\System.Runtime.InteropServices.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Runtime.InteropServices.WindowsRuntime"
          Name="System.Runtime.InteropServices.WindowsRuntime.dll"
          Source="$(var.Net45FacadeDirectory)\System.Runtime.InteropServices.WindowsRuntime.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Runtime.Numerics"
          Name="System.Runtime.Numerics.dll"
          Source="$(var.Net45FacadeDirectory)\System.Runtime.Numerics.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Runtime.Serialization.Json"
          Name="System.Runtime.Serialization.Json.dll"
          Source="$(var.Net45FacadeDirectory)\System.Runtime.Serialization.Json.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Runtime.Serialization.Primitives"
          Name="System.Runtime.Serialization.Primitives.dll"
          Source="$(var.Net45FacadeDirectory)\System.Runtime.Serialization.Primitives.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Runtime.Serialization.Xml"
          Name="System.Runtime.Serialization.Xml.dll"
          Source="$(var.Net45FacadeDirectory)\System.Runtime.Serialization.Xml.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Security.Principal"
          Name="System.Security.Principal.dll"
          Source="$(var.Net45FacadeDirectory)\System.Security.Principal.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.ServiceModel.Duplex"
          Name="System.ServiceModel.Duplex.dll"
          Source="$(var.Net45FacadeDirectory)\System.ServiceModel.Duplex.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.ServiceModel.Http"
          Name="System.ServiceModel.Http.dll"
          Source="$(var.Net45FacadeDirectory)\System.ServiceModel.Http.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.ServiceModel.NetTcp"
          Name="System.ServiceModel.NetTcp.dll"
          Source="$(var.Net45FacadeDirectory)\System.ServiceModel.NetTcp.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.ServiceModel.Primitives"
          Name="System.ServiceModel.Primitives.dll"
          Source="$(var.Net45FacadeDirectory)\System.ServiceModel.Primitives.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.ServiceModel.Security"
          Name="System.ServiceModel.Security.dll"
          Source="$(var.Net45FacadeDirectory)\System.ServiceModel.Security.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Text.Encoding"
          Name="System.Text.Encoding.dll"
          Source="$(var.Net45FacadeDirectory)\System.Text.Encoding.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Text.Encoding.Extensions"
          Name="System.Text.Encoding.Extensions.dll"
          Source="$(var.Net45FacadeDirectory)\System.Text.Encoding.Extensions.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Text.RegularExpressions"
          Name="System.Text.RegularExpressions.dll"
          Source="$(var.Net45FacadeDirectory)\System.Text.RegularExpressions.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Threading"
          Name="System.Threading.dll"
          Source="$(var.Net45FacadeDirectory)\System.Threading.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Threading.Tasks"
          Name="System.Threading.Tasks.dll"
          Source="$(var.Net45FacadeDirectory)\System.Threading.Tasks.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Threading.Tasks.Parallel"
          Name="System.Threading.Tasks.Parallel.dll"
          Source="$(var.Net45FacadeDirectory)\System.Threading.Tasks.Parallel.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Xml.ReaderWriter"
          Name="System.Xml.ReaderWriter.dll"
          Source="$(var.Net45FacadeDirectory)\System.Xml.ReaderWriter.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Xml.XDocument"
          Name="System.Xml.XDocument.dll"
          Source="$(var.Net45FacadeDirectory)\System.Xml.XDocument.dll"
          KeyPath="yes" />
      </Component>
      <Component>
        <File Id="System.Xml.XmlSerializer"
          Name="System.Xml.XmlSerializer.dll"
          Source="$(var.Net45FacadeDirectory)\System.Xml.XmlSerializer.dll"
          KeyPath="yes" />
      </Component>

    </ComponentGroup>

  </Fragment>
</Wix>